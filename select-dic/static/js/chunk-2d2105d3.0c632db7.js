(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d2105d3"],{b829:function(e,t,o){"use strict";function n(e,t){if(null==e)return{};var o,n,a={},r=Object.keys(e);for(n=0;n<r.length;n++)o=r[n],t.indexOf(o)>=0||(a[o]=e[o]);return a}function a(e,t){if(null==e)return{};var o,a,r=n(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)o=s[a],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(r[o]=e[o])}return r}o.r(t);o("a481"),o("4917");var r,s,c=o("4360"),i=o("0fea"),u=(o("a78e"),o("5f87")),l=["redirect","token"],d={name:"AuthRedirect",data:function(){return{url:"",code:"",hasToken:!1,redirectPath:""}},created:function(){console.log(location),console.log(this.$route.query),this.$route.query&&(this.redirectPath=this.$route.query.redirect);var e=window.navigator.userAgent.toLowerCase();if("micromessenger"==e.match(/MicroMessenger/i)){console.log("微信浏览器");var t=Object(u["a"])();t?this.getUserInfo():this.getAuthUrl()}else{var o=Object(u["a"])();console.log("不是微信浏览器"+Object(u["a"])()),o?this.getUserInfo():this.onGetUserTicketPC()}},watch:{"$route.query":function(e){this.redirectPath=e.redirect}},methods:{getNatural:function(e,t){var o=(new Date).valueOf(),n=this,a={app_id:"wdhf",biz_content:JSON.stringify({username:e,jwtToken:t}),charset:"UTF-8",interface_id:"zrrxxcx",origin:"APP",sign:"",timestamp:o,version:"1.0"};$.ajax({dataType:"json",type:"post",url:"https://www.sczwfw.gov.cn/tftb/jmas-api-gateway-server/createsign.do",data:a,success:function(e){a.sign=e.data.sign,n.getNaturalData(a)},fail:function(){}})},getNaturalData:function(e){var t=this;$.ajax({dataType:"json",type:"post",url:"https://www.sczwfw.gov.cn/tftb/jmas-api-gateway-server/gateway.do",data:e,success:function(e){if(console.log("自然人用户数据",e),e.success&&"200"==e.code&&(e=JSON.parse(e.data),e)){var o=e.data.real,n=e.data.base;console.log(o);var a={infos:e.data,username:n.username,userPassword:n.uuid,uuid:n.uuid,realName:o.realName,sex:o.sex,idNumber:o.idNumber};t.onLoginByPlatform(a)}},fail:function(){}})},onLoginByPlatform:function(e){var t=this;Object(i["a"])("/Wx/loginByPlatform",{body:e}).then((function(e){0==e.code&&(1==e.data.checkstate?(Object(u["c"])(e.data.token),c["a"].dispatch("user/setToken",e.data.token),t.Toast("静默登录成功"),t.getUserInfo()):0==e.data.checkstate&&t.Toast("静默登录失败"))})).catch((function(e){console.log(e)}))},onGetUserTicketPC:function(){var e=this;$.ajax({type:"get",async:!1,dataType:"jsonp",jsonpCallback:"jsonpCallback",contentType:"application/json; charset=utf-8",url:"https://www.sczwfw.gov.cn/juspace/interface/auth/curMemberInner",success:function(t){var o=t.success;if(o){$(".big-box").css("display","block"),console.log("获取平台信息",t.data);var n=t.data.curMember,a=n.encodeIdNumber,r=n.encodeRealName,s=n.encodeEmployeeMobile,c=e.decrypt(a),i=e.decrypt(r),u=e.decrypt(s),l={username:u,userPassword:n.uuid,uuid:n.uuid,realName:i,sex:e.getSex(c),idNumber:c};e.onLoginByPlatform(l)}else setTimeout((function(){let url='https://www.sczwfw.gov.cn/juspace/front/sso/login';let loginUrl="";try{loginUrl=location.href}catch(e){loginUrl=document.referrer}if(loginUrl&&loginUrl!==""){url+="?src="+window.btoa(unescape(encodeURIComponent(loginUrl)))}window.location.href=url;}),1500)}})},getSex:function(e){return e.charAt(16)%2===0?2:1},onGetUserTicket:function(){var e=this;lightAppJssdk.user.getTicket({success:function(t){if("未登录"==t)e.onLoginApp();else{var o=JSON.parse(t);console.log("userInfo~~~~~~~",o),o.socialCreditCode?e.$dialog.alert({message:"此服务不支持法人用户"}).then((function(){e.oncloseWindow()})):e.getNatural(o.username,o.jwtToken)}},fail:function(t){e.oncloseWindow()}})},onLoginApp:function(){var e=this;lightAppJssdk.user.loginapp({success:function(t){if("未登录"==t)e.oncloseWindow();else{var o=JSON.parse(t);console.log("userInfo~~~~~~~",o),o.socialCreditCode?e.$dialog.alert({message:"此服务不支持法人用户"}).then((function(){e.oncloseWindow()})):e.getNatural(o.username,o.jwtToken)}},fail:function(){e.oncloseWindow()}})},oncloseWindow:function(){lightAppJssdk.navigation.close({success:function(e){},fail:function(e){}})},getAuthUrl:function(){var e=this;this.getCodeUrlBefore()&&(console.log("回调路径",location.href),Object(i["a"])("/getcodeUrl",{body:location.href}).then((function(t){0==t.code&&(Object(u["b"])(),e.url=t.data,e.getCode())})).catch((function(e){console.log(e)})))},getCodeUrlBefore:function(){var e=this.$route.query.token;return!e||(this.token=e,Object(u["c"])(e),this.getUserInfo(),!1)},getCode:function(){this.token=this.$route.query.token||"",this.token?(Object(u["c"])(this.token),this.getUserInfo()):window.location.replace(this.url)},getUserInfo:function(){var e=this;console.log("token",this.token),this.$store.dispatch("user/getInfo",{Token:this.token}).then((function(){var t=e.redirectPath;console.log("进入的页面 pathname",t);var o=e.$route.query,n=(o.redirect,o.token,a(o,l));console.log(n,"路由参数"),t&&"/"!=t&&"/login"!=t?e.$router.replace({path:t,query:n||{}}):e.$router.replace({path:"/index",query:n||{}})})).catch((function(){}))},decrypt:function(e){var t="MIICeAIBADANBgkqhkiG9w0BAQEFAASCAmIwggJeAgEAAoGBAJJuFUH/4m9H5hCCzxtd9BxpjWlG9gbejqiJpV0XJKaU1V7xDBJasswxPY7Zc15RoxWClPoKPwKrbWKm49dgBJebJq5xd4sLCSbboxRkKxpRiJHMZ4LJjYa5h9Ei9RyfoUzqGHqH4UrDy3m3IwPiP19cIBqoU50shyQf92ZpcGZhAgMBAAECgYEAiadU8pODoUs82x6tZbPALQmJN4PO+wwznfqv6sA74yGdKECAMazz0oMjtGt1SiCCqFD2jcweCftvvELZg3mvNg1V0vRQRD1ZCA8HDp8DXm20d11K3+RX39tR4KgyyM3HsSEhkUDujMxKIpYjyiB5iEtV7Ja9bZ2fROszq+mUIqUCQQDQQf6vWRMLBqfnDcU77vuDGOhXbjkF2ytLxLW3fbKaW3GWvC3n93zPM+mcvWSXgkl448+jFjpMktm1Vn+w+YX3AkEAs/+bbRbod6AcVbLu8C5E44qDRoRpu+LF7Cphp8tlSAIRjm2yGP5acMWGRUtH9MF2QJYPF0PgDzdmUSVqWnCAZwJBALnSuRri4wAKn1SmT+ALfLZcSiyBODZGeppv2ijw6qWahH8YR+ncRaxoyMFHqPMbmM1akJIXqktbGREaLnPOIb8CQQCdJycJaL3Qa98xR4dr9cm5rF6PO96g5w6M8jfO6ztjUkMHymh7f99wpFRlvaN2Y06edyV315ARWPohEPy5N44zAkBlLuDHLm1TkTTAfdlL5r2OcdjpaJYloTdn05Mp3+J+w1zTX8k6Mz8lFZtLUcoMeTfQ9rm/+u2KwxS8NljtSZWH",o=new JSEncrypt;o.setPrivateKey("-----BEGIN RSA PRIVATE KEY-----"+t+"-----END RSA PRIVATE KEY-----");var n=o.decrypt(e);return n}},render:function(e){return e()}},f=d,g=o("2877"),p=Object(g["a"])(f,r,s,!1,null,null,null);t["default"]=p.exports}}]);